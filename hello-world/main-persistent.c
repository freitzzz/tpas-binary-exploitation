#include <stdio.h>

__AFL_FUZZ_INIT();

int main(int argc, char **argv)
{

#ifdef __AFL_HAVE_MANUAL_CONTROL
    __AFL_INIT();
#endif

    unsigned char *buf = __AFL_FUZZ_TESTCASE_BUF;

    while (__AFL_LOOP(10000))
    {

        int len = __AFL_FUZZ_TESTCASE_LEN; // don't use the macro directly in a
                                           // call!

        if (len < 8)
            continue; // check for a required/useful minimum input length

        /* Setup function call, e.g. struct target *tmp = libtarget_init() */
        /* Call function to be fuzzed, e.g.: */

        printf("What's your name?\n");

        char name[8];

        gets(name);

        printf("Your name is: %s\n", name);

        /* Reset state. e.g. libtarget_free(tmp) */
    }

    return 0;
}
